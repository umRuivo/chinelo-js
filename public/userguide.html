<!-- Note: This project now uses npm instead of bun. -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Guide</title>
    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <header>
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
            <div class="container-fluid">
                <a class="navbar-brand" href="/" + globalData.sufix>Chinelo JS</a>
                <div class="collapse navbar-collapse">
                    <ul class="navbar-nav">
                        <li class="nav-item">
                            <a class="nav-link" href="/" + globalData.sufix>Home</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/userguide.html" + globalData.sufix>User Guide</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/examples.html" + globalData.sufix>Examples</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/whatis.html">O que somos?</a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>
    <main class="container mt-4">
        <h1>Chinelo.js - Sistema de Auto-Rotas para Express.js</h1>
        <p>Chinelo.js é um sistema de backend leve e extensível para Node.js e Express, projetado para simplificar a criação de APIs e aplicações web. O core do sistema é um mecanismo de roteamento automático que gera rotas RESTful a partir dos seus controllers, permitindo que você se concentre na lógica de negócios em vez de na configuração de rotas.</p>

        <h2>Funcionalidades</h2>
        <ul>
            <li><strong>Roteamento Automático:</strong> As rotas são geradas automaticamente a partir dos arquivos e funções nos seus controllers.</li>
            <li><strong>Convenção sobre Configuração:</strong> Inferência inteligente de métodos HTTP (GET, POST, PUT, DELETE) baseada nos nomes das funções.</li>
            <li><strong>Configuração Centralizada:</strong> Gerencie as configurações da sua aplicação em um único arquivo (<code>chinelo.config.js</code>).</li>
            <li><strong>Flexível:</strong> Permite a definição de rotas personalizadas, middlewares e parâmetros de rota diretamente nos controllers.</li>
            <li><strong>Prisma ORM:</strong> Integração com o Prisma para uma interação moderna e segura com o banco de dados.</li>
            <li><strong>View Engine:</strong> Suporte para renderização de views no servidor com Pug.</li>
            <li><strong>Modo API:</strong> Alterne facilmente entre uma aplicação web tradicional e uma API JSON pura.</li>
        </ul>

        <h2>Como Funciona</h2>
        <p>O sistema utiliza o <code>autoRoutes.js</code> para escanear o diretório <code>src/controllers</code>. Para cada função exportada em um arquivo de controller, uma rota é registrada no Express.</p>
        <ul>
            <li><strong>Nome do Controller:</strong> O nome do arquivo (sem a extensão <code>.js</code>) se torna a base da rota (ex: <code>user.js</code> → <code>/user</code>).</li>
            <li><strong>Nome da Função:</strong> O nome da função se torna o endpoint (ex: <code>function list()</code> → <code>/user/list</code>).</li>
            <li><strong>Metadados de Rota:</strong> Os metadados da rota (método HTTP, parâmetros e middlewares) são definidos em arrays exportados:
<pre><code>export const middlewares = [
    ['minhaFuncao', [authMiddleware, adminMiddleware]]
];

export const httpMethods = [
    ['minhaFuncao', 'POST']
];

export const routeParams = [
    ['minhaFuncao', ['id']] // Gera a rota /controller/minhaFuncao/:id
];
</code></pre></li>
        </ul>

        <h2>Middlewares Globais</h2>
        <p>Os middlewares que são aplicados a todas as rotas da aplicação foram centralizados em <code>core/middlewares/global.middleware.js</code>. Isso inclui a configuração de sessão, parsers de corpo de requisição, arquivos estáticos, CORS, e o middleware de autenticação global (se aplicável). O handler de 404 também é definido no <code>server.js</code> após o registro de todas as rotas.</p>

        <h2>Estrutura do Projeto</h2>
<pre><code>/
├── prisma/                 # Configuração e migrações do Prisma
├── public/                 # Arquivos estáticos (CSS, JS, imagens)
├── src/
│   ├── controllers/        # Lógica de controle da aplicação
│   ├── middlewares/        # Middlewares de autenticação, validação, etc.
│   ├── models/             # Lógica de acesso a dados (usando Prisma)
│   └── views/              # Arquivos de template (Pug)
├── core/
│   ├── autoRoutes.js       # Core do sistema de auto-rotas
│   ├── helpers/            # Funções auxiliares
│   ├── middlewares/        # Middlewares globais do core
│   └── scripts/            # Scripts de automação
├── chinelo.config.js       # Arquivo de configuração principal
├── custom.routes.js        # Definição de rotas manuais
├── server.js               # Ponto de entrada da aplicação
└── package.json
</code></pre>

        <h2>Instalação e Uso</h2>
        <ol>
            <li><strong>Clone o repositório:</strong>
<pre><code>git clone https://github.com/umRuivo/chinelo-js.git
cd chinelo-js
</code></pre></li>
            <li><strong>Instale as dependências:</strong>
<pre><code>npm install
</code></pre></li>
            <li><strong>Configure o ambiente:</strong>
                <ul>
                    <li>Renomeie o arquivo <code>.env.example</code> para <code>.env</code>.</li>
                    <li>Adicione a URL do seu banco de dados no arquivo <code>.env</code>:
<pre><code>DATABASE_URL="mysql://usuario:senha@servidor:porta/banco"
</code></pre></li>
                </ul>
            </li>
            <li><strong>Execute as migrações do Prisma:</strong>
<pre><code>npx prisma migrate dev --name init
</code></pre></li>
            <li><strong>Inicie o servidor:</strong>
                <ul>
                    <li><strong>Desenvolvimento (com hot-reload):</strong>
<pre><code>npm run dev
</code></pre></li>
                    <li><strong>Produção:</strong>
<pre><code>npm start
</code></pre></li>
                </ul>
            </li>
        </ol>
        <p>O servidor estará rodando em <code>http://localhost:3000</code> (ou na porta definida em <code>chinelo.config.js</code>).</p>

        <h2>Configuração (<code>chinelo.config.js</code>)</h2>
        <p>O arquivo <code>chinelo.config.js</code> permite customizar o comportamento da aplicação:</p>
        <ul>
            <li><code>port</code>: Porta do servidor.</li>
            <li><code>siteIP</code>: Endereço IP do servidor.</li>
            <li><code>urlViews</code>: Diretório das views.</li>
            <li><code>dirPublic</code>: Diretório de arquivos públicos.</li>
            <li><code>templateEngine</code>: Motor de templates (ex: 'pug').</li>
            <li><code>pageNotFound</code>: Nome do arquivo da view de página não encontrada.</li>
            <li><code>msgNotFound</code>: Mensagem exibida quando a página não é encontrada.</li>
            <li><code>activeLimiter</code>: Ativa ou desativa o limitador de requisições.</li>
            <li><code>apiMode</code>: <code>true</code> para uma API JSON, <code>false</code> para uma aplicação web com views.</li>
            <li><code>routeSufix</code>: Sufixo adicionado a todas as rotas (ex: '/index.html').</li>
            <li><code>globalRoutePrefix</code>: Prefixo global adicionado a todas as rotas (ex: 'admin/').</li>
            <li><code>maxRequests</code>: Número máximo de requisições permitidas dentro do <code>maxRequestsTime</code>.</li>
            <li><code>maxRequestsTime</code>: Tempo em minutos para o limite de requisições.</li>
            <li><code>maxRequestsMessage</code>: Mensagem exibida quando o limite de requisições é excedido.</li>
            <li><code>globalData</code>: Objeto contendo dados globais para as views, como <code>siteName</code>, <code>author</code>, <code>prefix</code>, <code>sufix</code> e <code>sessionTime</code>.</li>
        </ul>

        <h2>Contribuindo</h2>
        <p>Contribuições são bem-vindas! Sinta-se à vontade para abrir uma issue ou enviar um pull request.</p>
    </main>
    </main>
    <script src="/js/bootstrap.bundle.min.js"></script>
</body>
</html>
